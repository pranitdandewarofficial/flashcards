<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FlashLearn AI - Enhanced</title>
  <style>
    :root {
      --bg-light: #f3f4f6;
      --bg-dark: #111827;
      --card-light: #ffffff;
      --card-dark: #1f2937;
      --text-light: #111827;
      --text-dark: #f9fafb;
      --accent: #6366f1;
      --success: #22c55e;
      --warning: #f59e42;
      --danger: #ef4444;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Segoe UI', 'Roboto', sans-serif;
      transition: background-color 0.3s ease, color 0.3s ease;
      min-height: 100vh;
      padding: 2rem;
      line-height: 1.6;
    }

    .container {
      max-width: 900px;
      margin: auto;
    }

    body.light {
      background-color: var(--bg-light);
      color: var(--text-light);
    }

    body.dark {
      background-color: var(--bg-dark);
      color: var(--text-dark);
    }

    header {
      text-align: center;
      margin-bottom: 2rem;
      position: relative;
    }

    .header-content {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1rem;
    }

    .header-img-container {
      position: relative;
      width: 140px;
      height: 180px;
    }

    .header-img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 1.2rem;
      box-shadow: 0 4px 24px #6366f122;
      animation: photoPopIn 1.1s cubic-bezier(.4,2,.3,1);
      transition: transform 0.35s cubic-bezier(.4,2,.3,1), box-shadow 0.35s;
    }
    
    .header-img:hover {
      transform: scale(1.07) rotate(-2deg) translateY(-6px);
      box-shadow: 0 8px 32px #6366f144;
    }
    
    @keyframes photoPopIn {
      from { opacity: 0; transform: scale(0.7) translateY(40px); }
      to { opacity: 1; transform: scale(1) translateY(0); }
    }

    h1 {
      font-size: 2.5rem;
      text-align: center;
      background: linear-gradient(90deg, #6366f1, #ec4899);
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
      margin: 0;
      padding: 0.5rem 0 0.25rem;
    }

    .subtitle {
      text-align: center;
      color: #6b7280;
      font-size: 1.1rem;
      max-width: 600px;
      margin: 0 auto;
    }

    .generator {
      display: flex;
      gap: 1rem;
      margin: 2rem 0;
      flex-direction: column;
    }

    #topic-input {
      padding: 0.75rem;
      font-size: 1rem;
      border-radius: 0.5rem;
      border: 1px solid #d1d5db;
      width: 100%;
      font-family: inherit;
      transition: border-color 0.3s, box-shadow 0.3s;
    }

    #topic-input:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2);
    }

    #generate-btn {
      padding: 0.75rem;
      font-size: 1rem;
      border: none;
      border-radius: 0.5rem;
      background: var(--accent);
      color: white;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 600;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
    }
    
    #generate-btn:hover {
      background: #4f46e5;
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }
    
    #generate-btn:disabled {
      opacity: 0.7;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    .controls {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin: 1rem 0;
      flex-wrap: wrap;
      gap: 1rem;
    }

    .control-group {
      display: flex;
      gap: 0.5rem;
    }

    .btn {
      padding: 0.5rem 1rem;
      border-radius: 0.5rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .btn-primary {
      background: var(--accent);
      color: white;
      border: none;
    }

    .btn-secondary {
      background: transparent;
      border: 1px solid var(--accent);
      color: var(--accent);
    }

    .btn-danger {
      background: var(--danger);
      color: white;
      border: none;
    }

    .btn-success {
      background: var(--success);
      color: white;
      border: none;
    }

    .btn-warning {
      background: var(--warning);
      color: white;
      border: none;
    }

    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    .btn:active {
      transform: translateY(0);
    }

    /* Flashcard styles */
    .flashcards-section {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 1.5rem;
      margin: 2.5rem 0 2rem 0;
    }

    .flashcard {
      background: linear-gradient(120deg, #f3f4f6 60%, #e0e7ff 100%);
      border-radius: 1.2rem;
      box-shadow: 0 4px 16px #6366f122;
      padding: 1.5rem;
      min-height: 200px;
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      justify-content: space-between;
      position: relative;
      transition: all 0.3s ease;
      cursor: pointer;
      overflow: hidden;
      border: 1.5px solid #a5b4fc;
      touch-action: manipulation;
    }
    
    .dark .flashcard {
      background: linear-gradient(120deg, #1f2937 60%, #374151 100%);
      border-color: #4b5563;
    }
    
    .flashcard:hover, .flashcard:focus-within {
      box-shadow: 0 8px 32px #6366f144;
      transform: scale(1.04) translateY(-6px) rotate(-1deg);
      z-index: 2;
    }
    
    .flashcard.show-answer {
      transform: scale(1.03);
      box-shadow: 0 8px 32px #6366f144;
    }
    
    .flashcard .question {
      font-size: 1.15em;
      font-weight: 600;
      color: #4338ca;
      margin-bottom: 1.1em;
      letter-spacing: 0.01em;
      width: 100%;
    }
    
    .dark .flashcard .question {
      color: #a5b4fc;
    }
    
    .flashcard .answer {
      font-size: 1.05em;
      color: #22223b;
      background: #e0e7ff;
      border-radius: 0.7em;
      padding: 0.7em 1em;
      box-shadow: 0 1px 4px #6366f111;
      display: none;
      width: 100%;
      transition: all 0.3s;
    }
    
    .dark .flashcard .answer {
      background: #374151;
      color: #f3f4f6;
    }
    
    .flashcard.show-answer .answer {
      display: block;
      animation: fadeInAnswer 0.5s;
    }
    
    .flashcard .actions {
      margin-top: 1em;
      display: flex;
      gap: 0.7em;
      width: 100%;
      justify-content: flex-end;
    }
    
    .flashcard .actions button {
      background: #6366f1;
      color: #fff;
      border: none;
      border-radius: 0.7em;
      padding: 0.3em 0.9em;
      font-size: 0.98em;
      cursor: pointer;
      transition: background 0.2s;
    }
    
    .flashcard .actions button.known { background: var(--success); }
    .flashcard .actions button.difficult { background: var(--danger); }
    .flashcard .actions button.edit { background: var(--warning); }
    .flashcard .actions button.delete { background: #6366f1; }
    
    .flashcard .actions button:focus { 
      outline: 2px solid #6366f1;
      outline-offset: 2px;
    }
    
    @keyframes fadeInAnswer {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* Progress bar */
    .progress-section {
      background: rgba(199, 210, 254, 0.3);
      border-radius: 1rem;
      padding: 1.5rem;
      margin: 2rem 0;
    }
    
    .progress-header {
      display: flex;
      justify-content: space-between;
      margin-bottom: 0.5rem;
    }
    
    .progress-bar {
      width: 100%;
      background: #e0e7ff;
      border-radius: 1em;
      margin: 1.5em 0 1em 0;
      height: 1.1em;
      overflow: hidden;
    }
    
    .dark .progress-bar {
      background: #374151;
    }
    
    .progress-bar-inner {
      height: 100%;
      background: linear-gradient(90deg, #6366f1, #22c55e);
      border-radius: 1em;
      transition: width 0.5s;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 0.7rem;
      font-weight: bold;
    }
    
    /* Motivational quote */
    .motivation {
      text-align: center;
      color: #4338ca;
      font-size: 1.13em;
      font-weight: 500;
      margin: 1.5em 0 0.5em 0;
      font-style: italic;
    }
    
    .dark .motivation {
      color: #a5b4fc;
    }

    /* Search/filter bar */
    .search-bar {
      width: 100%;
      max-width: 500px;
      margin: 1em auto 1.5em auto;
      display: flex;
      gap: 0.5em;
    }
    
    .search-bar input {
      flex: 1;
      padding: 0.6em 1em;
      border-radius: 0.7em;
      border: 1.5px solid #a5b4fc;
      font-size: 1em;
      background: white;
    }
    
    .dark .search-bar input {
      background: #1f2937;
      border-color: #4b5563;
      color: white;
    }
    
    .search-bar button {
      background: #6366f1;
      color: #fff;
      border: none;
      border-radius: 0.7em;
      padding: 0.3em 1em;
      font-size: 1em;
      cursor: pointer;
      transition: background 0.2s;
    }
    
    .search-bar button:hover {
      background: #4f46e5;
    }

    /* Status messages */
    .status-message {
      text-align: center;
      padding: 1rem;
      border-radius: 0.5rem;
      margin: 1rem 0;
      display: none;
    }
    
    .status-success {
      background-color: #dcfce7;
      color: #166534;
      border: 1px solid #bbf7d0;
    }
    
    .status-error {
      background-color: #fee2e2;
      color: #b91c1c;
      border: 1px solid #fecaca;
    }
    
    .status-info {
      background-color: #dbeafe;
      color: #1d4ed8;
      border: 1px solid #bfdbfe;
    }

    /* Info section */
    .info-section {
      max-width: 700px;
      margin: 2.5rem auto 2rem auto;
      padding: 2rem 1.5rem;
      background: linear-gradient(120deg,#e0e7ff 60%,#f3f4f6 100%);
      border-radius: 1.5rem;
      box-shadow: 0 4px 24px #6366f122;
    }
    
    .dark .info-section {
      background: linear-gradient(120deg,#1f2937 60%,#111827 100%);
    }
    
    .info-section h2 {
      color: #6366f1;
      text-align: center;
      margin-bottom: 0.7em;
      font-size: 2em;
      font-weight: 700;
      letter-spacing: 0.01em;
    }
    
    .info-section ul {
      list-style: none;
      padding: 0;
      margin: 0 0 1.2em 0;
    }
    
    .info-section li {
      display: flex;
      align-items: flex-start;
      margin-bottom: 1.1em;
    }
    
    .info-section li span {
      font-size: 1.5em;
      margin-right: 0.7em;
      min-width: 30px;
    }
    
    .info-section .highlight {
      color: #4338ca;
      font-size: 1.13em;
      font-weight: 500;
      text-align: center;
    }
    
    .dark .info-section .highlight {
      color: #a5b4fc;
    }

    /* Developer modal */
    .dev-modal-bg {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(30,41,59,0.85);
      z-index: 1000;
      align-items: center;
      justify-content: center;
    }
    
    .dev-modal-bg.active {
      display: flex !important;
    }
    
    .dev-card {
      background: #fff;
      padding: 3em 2.5em 2em 2.5em;
      border-radius: 1.7em;
      box-shadow: 0 12px 40px #6366f155;
      max-width: 420px;
      margin: auto;
      position: relative;
      text-align: center;
      animation: fadeIn 0.5s;
    }
    
    .dark .dev-card {
      background: #1f2937;
      color: #f9fafb;
    }
    
    .dev-close {
      position: absolute;
      top: 0.7em;
      right: 1em;
      background: none;
      border: none;
      font-size: 2em;
      color: #6366f1;
      cursor: pointer;
      transition: transform 0.2s;
    }
    
    .dev-close:hover {
      transform: scale(1.1);
    }
    
    .dev-links a {
      color: #6366f1;
      text-decoration: none;
      font-weight: 500;
      margin-bottom: 0.3em;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      gap: 0.5em;
      padding: 0.5em 1em;
      border-radius: 0.5em;
    }
    
    .dev-links a:hover {
      background: #e0e7ff;
      color: #4338ca;
      transform: translateY(-2px);
    }
    
    .dark .dev-links a:hover {
      background: #374151;
      color: #a5b4fc;
    }
    
    .dev-links {
      margin-top: 1.2em;
      display: flex;
      flex-direction: column;
      gap: 0.7em;
    }
    
    .dev-img-animate {
      animation: imgPop 0.8s cubic-bezier(.4,2,.3,1);
    }
    
    @keyframes fadeIn {
      from { opacity:0; transform:scale(0.95);} 
      to { opacity:1; transform:scale(1);}
    }
    
    @keyframes imgPop { 
      0% { transform: scale(0.7) rotate(-8deg); opacity: 0; } 
      60% { transform: scale(1.1) rotate(2deg); opacity: 1; } 
      100% { transform: scale(1) rotate(0); opacity: 1; } 
    }

    /* Loading spinner */
    .spinner {
      width: 24px;
      height: 24px;
      border: 3px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      border-top-color: white;
      animation: spin 1s ease-in-out infinite;
      display: none;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    /* Auth section */
    .auth-section {
      text-align: center;
      margin: 2em 0 1.5em 0;
      padding: 1.5rem;
      border-radius: 1rem;
      background: rgba(199, 210, 254, 0.2);
    }
    
    .auth-buttons {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 0.5rem;
      margin-top: 1rem;
    }
    
    .auth-btn {
      background: #fff;
      color: #6366f1;
      border: 1.5px solid #6366f1;
      padding: 0.6em 1.2em;
      border-radius: 1em;
      font-size: 1em;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      transition: all 0.2s;
    }
    
    .auth-btn:hover {
      background: #e0e7ff;
      transform: translateY(-2px);
    }
    
    .auth-btn.github {
      color: #22223b;
      border-color: #22223b;
    }
    
    .auth-btn.github:hover {
      background: #f3f4f6;
    }
    
    .user-info {
      margin-bottom: 1em;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    
    .user-avatar {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      object-fit: cover;
      margin-bottom: 0.5rem;
      border: 2px solid #6366f1;
    }
    
    /* Footer */
    footer {
      margin-top: 2.5rem;
      text-align: center;
      color: #6366f1;
      font-size: 1.05em;
      padding: 1rem;
      border-top: 1px solid #e5e7eb;
    }
    
    .dark footer {
      border-color: #374151;
    }
    
    footer a {
      color: #6366f1;
      text-decoration: none;
      font-weight: 600;
      transition: all 0.2s;
    }
    
    footer a:hover {
      text-decoration: underline;
      color: #4f46e5;
    }

    /* Responsive adjustments */
    @media (max-width: 768px) {
      body {
        padding: 1rem;
      }
      
      .controls {
        flex-direction: column;
        align-items: stretch;
      }
      
      .header-img-container {
        width: 120px;
        height: 160px;
      }
      
      h1 {
        font-size: 2rem;
      }
      
      .flashcards-section {
        grid-template-columns: 1fr;
      }
      
      .search-bar {
        flex-direction: column;
      }
    }
    
    @media (max-width: 480px) {
      .auth-buttons {
        flex-direction: column;
      }
      
      .auth-btn {
        justify-content: center;
      }
    }
  </style>
  <!-- Font Awesome CDN -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>
<body class="light">
  <div class="container">
    <!-- Authentication Section -->
    <div id="auth-section" class="auth-section">
      <div id="user-info" class="user-info" style="display: none;">
        <img id="user-avatar" class="user-avatar" src="" alt="User Avatar">
        <div id="user-name"></div>
      </div>
      <p>Sign in to save your flashcards and track progress</p>
      <div class="auth-buttons">
        <button id="login-google" class="auth-btn">
          <i class="fab fa-google"></i> Sign in with Google
        </button>
        <button id="login-github" class="auth-btn github">
          <i class="fab fa-github"></i> Sign in with GitHub
        </button>
        <button id="logout-btn" class="auth-btn" style="display: none;">
          <i class="fa-solid fa-sign-out-alt"></i> Logout
        </button>
      </div>
    </div>

    <!-- Main Content -->
    <div id="main-content" style="display: none;">
      <header>
        <div class="header-content">
          <div class="header-img-container">
            <img src="https://github.com/pranitdandewarofficial/flashcards/blob/c3a4e8f61a52db196443ac68c6411c385157264f/pranit.jpeg?raw=true" 
                 alt="Developer photo" class="header-img">
          </div>
          <div style="font-size:1.1em; color:#6366f1; margin-bottom:0.5rem; font-weight:500;">Hi, I'm PRANIT!</div>
          <h1>🧠 FlashLearn AI</h1>
          <p class="subtitle">Smart Flashcards for IIT JEE & NEET</p>
        </div>
      </header>

      <section class="generator">
        <input type="text" id="topic-input" placeholder="Enter topic like 'Photosynthesis' or 'Newton's Laws'" aria-label="Topic for flashcards">
        <button id="generate-btn">
          <i class="fas fa-bolt"></i> Generate Flashcards
          <div class="spinner" id="generate-spinner"></div>
        </button>
      </section>

      <!-- Status Message -->
      <div id="status-message" class="status-message"></div>

      <!-- Controls -->
      <div class="controls">
        <div class="control-group">
          <button id="theme-toggle" class="btn btn-secondary">
            <i class="fas fa-moon"></i> Dark Mode
          </button>
          <button id="font-toggle" class="btn btn-secondary">
            <i class="fas fa-text-height"></i> A+
          </button>
        </div>
        <div class="control-group">
          <button id="shuffle-btn" class="btn btn-secondary">
            <i class="fas fa-random"></i> Shuffle
          </button>
          <button id="export-btn" class="btn btn-secondary">
            <i class="fas fa-download"></i> Export
          </button>
        </div>
      </div>

      <!-- Progress Section -->
      <div class="progress-section">
        <div class="progress-header">
          <h3>Your Progress</h3>
          <span id="progress-text">0% Complete</span>
        </div>
        <div class="progress-bar">
          <div class="progress-bar-inner" id="progressBarInner" style="width: 0%">0%</div>
        </div>
        <p class="motivation" id="motivationQuote">"Success is the sum of small efforts, repeated day in and day out."</p>
      </div>

      <!-- Search Bar -->
      <div class="search-bar">
        <input type="text" id="searchInput" placeholder="Search flashcards..." aria-label="Search flashcards">
        <button onclick="searchFlashcards()">
          <i class="fas fa-search"></i> Search
        </button>
        <button onclick="resetSearch()">
          <i class="fas fa-sync"></i> Reset
        </button>
      </div>

      <!-- Flashcards Container -->
      <section class="flashcards-section" id="flashcardsSection"></section>

      <!-- Info Section -->
      <div class="info-section">
        <h2>Why Use Flashcards?</h2>
        <ul>
          <li>
            <span>🧠</span>
            <span><strong>Active Recall:</strong> Test yourself and boost memory retention by flipping cards and recalling answers.</span>
          </li>
          <li>
            <span>⏱️</span>
            <span><strong>Spaced Repetition:</strong> Review cards regularly to master tough concepts and never forget what matters.</span>
          </li>
          <li>
            <span>📚</span>
            <span><strong>Organized Learning:</strong> Group flashcards by chapter or topic for focused, efficient revision.</span>
          </li>
          <li>
            <span>✨</span>
            <span><strong>AI-Powered:</strong> Instantly generate high-quality flashcards for any subject or exam, tailored to your needs.</span>
          </li>
        </ul>
        <div class="highlight">Start learning smarter, not harder. Your journey to AIR 1 starts here!</div>
      </div>

      <!-- Developer Info Modal -->
      <div style="text-align:center; margin:2.5rem 0 1.5rem 0;">
        <button id="showDevBtn" class="btn btn-primary">
          <i class="fas fa-user"></i> About the Developer
        </button>
      </div>
      <div class="dev-modal-bg" id="devModal">
        <div class="dev-card">
          <button class="dev-close" id="closeDevBtn" title="Close">&times;</button>
          <img src="https://github.com/pranitdandewarofficial/flashcards/blob/c3a4e8f61a52db196443ac68c6411c385157264f/pranit.jpeg?raw=true" 
               alt="Developer photo" loading="eager" class="dev-img-animate" 
               style="width:150px;height:190px;object-fit:cover;border-radius:1.3rem;box-shadow:0 4px 18px #6366f122;margin-bottom:1.2rem;">
          <h1 style="color:#6366f1;font-size:2em;margin:0.7em 0 0.3em 0;letter-spacing:0.01em;">PRANIT DANDEWAR</h1>
          <p style="color:#22223b;font-size:1.18em;line-height:1.5;">
            Developer of <b>FlashLearn AI</b>.<br>Passionate about helping students achieve their dreams with smart, AI-powered learning tools.<br>
            <span style='color:#6366f1;font-size:1.05em;'>Let's connect and build the future of learning!</span>
          </p>
          <div class="dev-links">
            <a href="mailto:busines.pranit@email.com" title="Email" aria-label="Email">
              <i class="fa-solid fa-envelope"></i>Email
            </a>
            <a href="https://github.com/pranitdandewarofficial" target="_blank" title="GitHub" aria-label="GitHub">
              <i class="fab fa-github"></i>GitHub
            </a>
            <a href="https://twitter.com/pranitdandewar" target="_blank" title="Twitter" aria-label="Twitter">
              <i class="fab fa-twitter"></i>Twitter
            </a>
            <a href="https://linkedin.com/in/yourlinkedin" target="_blank" title="LinkedIn" aria-label="LinkedIn">
              <i class="fab fa-linkedin"></i>LinkedIn
            </a>
          </div>
        </div>
      </div>

      <footer>
        Made for <strong>AIR 1 IIT JEE Aspirants</strong> | Developed by <a href="#" id="dev-link">PRANIT</a>
      </footer>
    </div>
  </div>

  <script>
    // Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyBWXjy0y3xf_FjdPLoygm8IzPAsJkPP5Hs",
      authDomain: "pranit-dandewar.firebaseapp.com",
      projectId: "pranit-dandewar",
      storageBucket: "pranit-dandewar.appspot.com",
      messagingSenderId: "729828970412",
      appId: "1:729828970412:web:8cb3b430139fa446baf409",
      measurementId: "G-0FG5MCQ7TQ"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    // DOM Elements
    const authSection = document.getElementById('auth-section');
    const userInfo = document.getElementById('user-info');
    const userAvatar = document.getElementById('user-avatar');
    const userName = document.getElementById('user-name');
    const loginGoogleBtn = document.getElementById('login-google');
    const loginGithubBtn = document.getElementById('login-github');
    const logoutBtn = document.getElementById('logout-btn');
    const mainContent = document.getElementById('main-content');
    const themeToggle = document.getElementById('theme-toggle');
    const fontToggle = document.getElementById('font-toggle');
    const topicInput = document.getElementById('topic-input');
    const generateBtn = document.getElementById('generate-btn');
    const generateSpinner = document.getElementById('generate-spinner');
    const flashcardsSection = document.getElementById('flashcardsSection');
    const statusMessage = document.getElementById('status-message');
    const progressBarInner = document.getElementById('progressBarInner');
    const progressText = document.getElementById('progress-text');
    const motivationQuote = document.getElementById('motivationQuote');
    const searchInput = document.getElementById('searchInput');
    const showDevBtn = document.getElementById('showDevBtn');
    const devModal = document.getElementById('devModal');
    const closeDevBtn = document.getElementById('closeDevBtn');
    const shuffleBtn = document.getElementById('shuffle-btn');
    const exportBtn = document.getElementById('export-btn');
    const devLink = document.getElementById('dev-link');

    // App state
    let flashcards = [];
    let filteredFlashcards = [];
    let knownSet = new Set();
    let fontSize = localStorage.getItem('fontSize') || '1rem';
    let theme = localStorage.getItem('theme') || 'light';
    let motivationQuotes = [
      "Success is the sum of small efforts, repeated day in and day out.",
      "Don't watch the clock; do what it does. Keep going.",
      "The secret of getting ahead is getting started.",
      "Great things never come from comfort zones.",
      "Push yourself, because no one else is going to do it for you.",
      "The harder you work for something, the greater you'll feel when you achieve it.",
      "Dream it. Believe it. Build it.",
      "Your limitation—it's only your imagination."
    ];

    // Initialize theme
    document.body.className = theme;
    themeToggle.innerHTML = theme === 'dark' 
      ? '<i class="fas fa-sun"></i> Light Mode' 
      : '<i class="fas fa-moon"></i> Dark Mode';

    // Initialize font size
    document.body.style.fontSize = fontSize;

    // Set random motivation quote
    motivationQuote.textContent = motivationQuotes[Math.floor(Math.random() * motivationQuotes.length)];

    // Firebase Authentication
    function initAuth() {
      // Google Sign-In
      loginGoogleBtn.addEventListener('click', () => {
        const provider = new firebase.auth.GoogleAuthProvider();
        auth.signInWithPopup(provider)
          .then(handleSignIn)
          .catch(handleAuthError);
      });

      // GitHub Sign-In
      loginGithubBtn.addEventListener('click', () => {
        const provider = new firebase.auth.GithubAuthProvider();
        auth.signInWithPopup(provider)
          .then(handleSignIn)
          .catch(handleAuthError);
      });

      // Logout
      logoutBtn.addEventListener('click', () => {
        auth.signOut()
          .then(() => {
            showStatus('Signed out successfully', 'success');
            updateAuthUI(null);
          })
          .catch(handleAuthError);
      });

      // Auth state listener
      auth.onAuthStateChanged(user => {
        updateAuthUI(user);
        if (user) {
          loadFlashcards(user.uid);
        } else {
          loadLocalFlashcards();
        }
      });
    }

    function handleSignIn(result) {
      showStatus(`Welcome, ${result.user.displayName || 'User'}!`, 'success');
    }

    function handleAuthError(error) {
      console.error('Authentication error:', error);
      showStatus(`Authentication failed: ${error.message}`, 'error');
    }

    function updateAuthUI(user) {
      if (user) {
        // User is signed in
        userInfo.style.display = 'flex';
        userName.textContent = user.displayName || user.email;
        
        if (user.photoURL) {
          userAvatar.src = user.photoURL;
        } else {
          userAvatar.style.display = 'none';
        }
        
        loginGoogleBtn.style.display = 'none';
        loginGithubBtn.style.display = 'none';
        logoutBtn.style.display = 'block';
        mainContent.style.display = 'block';
      } else {
        // User is signed out
        userInfo.style.display = 'none';
        loginGoogleBtn.style.display = 'block';
        loginGithubBtn.style.display = 'block';
        logoutBtn.style.display = 'none';
        mainContent.style.display = 'block';
      }
    }

    // Flashcard Functions
    function loadFlashcards(userId) {
      db.collection('users').doc(userId).get()
        .then(doc => {
          if (doc.exists && doc.data().flashcards) {
            flashcards = doc.data().flashcards;
            filteredFlashcards = [...flashcards];
            renderFlashcards();
            updateProgress();
            showStatus('Flashcards loaded from cloud', 'success');
          } else {
            loadLocalFlashcards();
          }
        })
        .catch(error => {
          console.error('Error loading flashcards:', error);
          loadLocalFlashcards();
          showStatus('Using local flashcards', 'info');
        });
    }

    function loadLocalFlashcards() {
      const savedCards = localStorage.getItem('flashcards');
      if (savedCards) {
        flashcards = JSON.parse(savedCards);
        filteredFlashcards = [...flashcards];
        renderFlashcards();
        updateProgress();
      }
    }

    function saveFlashcards() {
      const user = auth.currentUser;
      if (user) {
        // Save to Firestore
        db.collection('users').doc(user.uid).set({ flashcards })
          .then(() => console.log('Flashcards saved to cloud'))
          .catch(error => console.error('Error saving to cloud:', error));
      }
      
      // Always save to localStorage
      localStorage.setItem('flashcards', JSON.stringify(flashcards));
    }

    function renderFlashcards() {
      flashcardsSection.innerHTML = '';
      
      if (filteredFlashcards.length === 0) {
        flashcardsSection.innerHTML = `
          <div class="empty-state">
            <i class="fas fa-lightbulb" style="font-size: 3rem; color: #a5b4fc; margin-bottom: 1rem;"></i>
            <h3>No Flashcards Yet</h3>
            <p>Enter a topic above to generate flashcards</p>
          </div>
        `;
        return;
      }
      
      filteredFlashcards.forEach((card, index) => {
        const flashcard = document.createElement('div');
        flashcard.className = 'flashcard';
        flashcard.innerHTML = `
          <div class="question">${card.front}</div>
          <div class="answer">${card.back}</div>
          <div class="actions">
            <button class="known" title="Mark as Known" data-index="${index}">
              <i class="fas fa-check"></i>
            </button>
            <button class="difficult" title="Mark as Difficult" data-index="${index}">
              <i class="fas fa-exclamation"></i>
            </button>
            <button class="delete" title="Delete" data-index="${index}">
              <i class="fas fa-trash"></i>
            </button>
          </div>
        `;
        
        // Add click event to show answer
        flashcard.addEventListener('click', (e) => {
          if (!e.target.closest('.actions')) {
            flashcard.classList.toggle('show-answer');
          }
        });
        
        flashcardsSection.appendChild(flashcard);
      });
      
      // Add event listeners to action buttons
      document.querySelectorAll('.flashcard .known').forEach(btn => {
        btn.addEventListener('click', (e) => {
          const index = parseInt(btn.dataset.index);
          markAsKnown(index);
        });
      });
      
      document.querySelectorAll('.flashcard .difficult').forEach(btn => {
        btn.addEventListener('click', (e) => {
          const index = parseInt(btn.dataset.index);
          markAsDifficult(index);
        });
      });
      
      document.querySelectorAll('.flashcard .delete').forEach(btn => {
        btn.addEventListener('click', (e) => {
          const index = parseInt(btn.dataset.index);
          deleteFlashcard(index);
        });
      });
    }

    function markAsKnown(index) {
      flashcards[index].known = !flashcards[index].known;
      if (flashcards[index].known) {
        knownSet.add(index);
      } else {
        knownSet.delete(index);
      }
      saveFlashcards();
      updateProgress();
      showStatus('Flashcard status updated', 'success');
    }

    function markAsDifficult(index) {
      flashcards[index].difficult = !flashcards[index].difficult;
      saveFlashcards();
      showStatus('Flashcard marked as difficult', 'info');
    }

    function deleteFlashcard(index) {
      if (confirm('Are you sure you want to delete this flashcard?')) {
        flashcards.splice(index, 1);
        saveFlashcards();
        filteredFlashcards = [...flashcards];
        renderFlashcards();
        updateProgress();
        showStatus('Flashcard deleted', 'success');
      }
    }

    function updateProgress() {
      const total = flashcards.length;
      const known = flashcards.filter(card => card.known).length;
      const percentage = total > 0 ? Math.round((known / total) * 100) : 0;
      
      progressBarInner.style.width = `${percentage}%`;
      progressBarInner.textContent = `${percentage}%`;
      progressText.textContent = `${percentage}% Complete (${known}/${total} known)`;
    }

    function generateFlashcards() {
      const topic = topicInput.value.trim();
      if (!topic) {
        showStatus('Please enter a topic', 'error');
        return;
      }
      
      generateBtn.disabled = true;
      generateSpinner.style.display = 'inline-block';
      showStatus('Generating flashcards...', 'info');
      
      // Simulate API call with mock data
      setTimeout(() => {
        const mockCards = [
          { front: "What is Newton's First Law?", back: "An object at rest stays at rest and an object in motion stays in motion unless acted upon by an external force." },
          { front: "What is Newton's Second Law?", back: "Force equals mass times acceleration (F = m × a)." },
          { front: "What is Newton's Third Law?", back: "For every action, there is an equal and opposite reaction." },
          { front: "What is the SI unit of force?", back: "Newton (N)." },
          { front: "Define acceleration.", back: "The rate of change of velocity with respect to time." },
          { front: "What is inertia?", back: "The resistance of any physical object to a change in its velocity." },
          { front: "State the law of conservation of momentum.", back: "The total momentum of a closed system remains constant if no external forces act on it." },
          { front: "What is the formula for kinetic energy?", back: "KE = ½ mv²" },
          { front: "Define work in physics.", back: "Work is done when a force causes displacement of an object (W = F × d)." },
          { front: "What is the difference between speed and velocity?", back: "Speed is scalar (magnitude only), velocity is vector (magnitude and direction)." }
        ];
        
        // Add new cards to the beginning
        flashcards = [...mockCards, ...flashcards];
        filteredFlashcards = [...flashcards];
        saveFlashcards();
        renderFlashcards();
        updateProgress();
        
        generateBtn.disabled = false;
        generateSpinner.style.display = 'none';
        showStatus(`Generated ${mockCards.length} flashcards on "${topic}"`, 'success');
        topicInput.value = '';
      }, 1500);
    }

    function searchFlashcards() {
      const query = searchInput.value.trim().toLowerCase();
      if (!query) {
        filteredFlashcards = [...flashcards];
        renderFlashcards();
        return;
      }
      
      filteredFlashcards = flashcards.filter(card => 
        card.front.toLowerCase().includes(query) || 
        card.back.toLowerCase().includes(query)
      );
      
      if (filteredFlashcards.length === 0) {
        showStatus('No flashcards match your search', 'info');
      } else {
        showStatus(`Found ${filteredFlashcards.length} matching flashcards`, 'success');
      }
      
      renderFlashcards();
    }

    function resetSearch() {
      searchInput.value = '';
      filteredFlashcards = [...flashcards];
      renderFlashcards();
      showStatus('Search reset', 'info');
    }

    function shuffleFlashcards() {
      for (let i = filteredFlashcards.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [filteredFlashcards[i], filteredFlashcards[j]] = [filteredFlashcards[j], filteredFlashcards[i]];
      }
      renderFlashcards();
      showStatus('Flashcards shuffled', 'success');
    }

    function exportFlashcards() {
      if (flashcards.length === 0) {
        showStatus('No flashcards to export', 'error');
        return;
      }
      
      const dataStr = JSON.stringify(flashcards, null, 2);
      const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
      
      const exportFileDefaultName = 'flashlearn-flashcards.json';
      
      const linkElement = document.createElement('a');
      linkElement.setAttribute('href', dataUri);
      linkElement.setAttribute('download', exportFileDefaultName);
      linkElement.click();
      
      showStatus('Flashcards exported successfully', 'success');
    }

    // UI Functions
    function toggleTheme() {
      theme = theme === 'light' ? 'dark' : 'light';
      document.body.className = theme;
      localStorage.setItem('theme', theme);
      
      themeToggle.innerHTML = theme === 'dark' 
        ? '<i class="fas fa-sun"></i> Light Mode' 
        : '<i class="fas fa-moon"></i> Dark Mode';
    }

    function toggleFontSize() {
      if (fontSize === '1rem') {
        fontSize = '1.1rem';
        fontToggle.innerHTML = '<i class="fas fa-text-height"></i> A-';
      } else {
        fontSize = '1rem';
        fontToggle.innerHTML = '<i class="fas fa-text-height"></i> A+';
      }
      document.body.style.fontSize = fontSize;
      localStorage.setItem('fontSize', fontSize);
    }

    function showStatus(message, type = 'info') {
      statusMessage.textContent = message;
      statusMessage.className = `status-message status-${type}`;
      statusMessage.style.display = 'block';
      
      // Auto-hide after 5 seconds
      setTimeout(() => {
        statusMessage.style.display = 'none';
      }, 5000);
    }

    function showDeveloperModal() {
      devModal.classList.add('active');
    }

    function closeDeveloperModal() {
      devModal.classList.remove('active');
    }

    // Event Listeners
    themeToggle.addEventListener('click', toggleTheme);
    fontToggle.addEventListener('click', toggleFontSize);
    generateBtn.addEventListener('click', generateFlashcards);
    topicInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') generateFlashcards();
    });
    showDevBtn.addEventListener('click', showDeveloperModal);
    closeDevBtn.addEventListener('click', closeDeveloperModal);
    devModal.addEventListener('click', (e) => {
      if (e.target === devModal) closeDeveloperModal();
    });
    shuffleBtn.addEventListener('click', shuffleFlashcards);
    exportBtn.addEventListener('click', exportFlashcards);
    searchInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') searchFlashcards();
    });
    devLink.addEventListener('click', (e) => {
      e.preventDefault();
      showDeveloperModal();
    });

    // Initialize the application
    document.addEventListener('DOMContentLoaded', () => {
      initAuth();
      loadLocalFlashcards();
    });
  </script>
</body>
</html>
