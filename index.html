<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FlashLearn AI</title>
  <style>
    :root {
      --bg-light: #f3f4f6;
      --bg-dark: #111827;
      --card-light: #ffffff;
      --card-dark: #1f2937;
      --text-light: #111827;
      --text-dark: #f9fafb;
      --accent: #6366f1;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      transition: background-color 0.3s ease, color 0.3s ease;
      min-height: 100vh;
      padding: 2rem;
    }

    .container {
      max-width: 900px;
      margin: auto;
    }

    body.light {
      background-color: var(--bg-light);
      color: var(--text-light);
    }

    body.dark {
      background-color: var(--bg-dark);
      color: var(--text-dark);
    }

    header {
      text-align: center;
      margin-bottom: 2rem;
    }

    header h1 {
      font-size: 2.5rem;
      text-align: center;
      background: linear-gradient(90deg, #6366f1, #ec4899);
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
      margin: 0;
      padding: 0.5rem 0 0.25rem;
    }

    header img {
      width: 140px;
      height: 180px;
      object-fit: cover;
      border-radius: 1.2rem;
      box-shadow: 0 4px 24px #6366f122;
      margin-bottom: 1rem;
      animation: photoPopIn 1.1s cubic-bezier(.4,2,.3,1);
      transition: transform 0.35s cubic-bezier(.4,2,.3,1), box-shadow 0.35s;
    }
    header img:hover {
      transform: scale(1.07) rotate(-2deg) translateY(-6px);
      box-shadow: 0 8px 32px #6366f144;
    }
    @keyframes photoPopIn {
      from { opacity: 0; transform: scale(0.7) translateY(40px); }
      to { opacity: 1; transform: scale(1) translateY(0); }
    }

    .generator {
      display: flex;
      gap: 1rem;
      margin: 2rem 0;
      flex-direction: column;
    }

    #topic-input {
      padding: 0.75rem;
      font-size: 1rem;
      border-radius: 0.5rem;
      border: 1px solid #ccc;
      width: 100%;
      font-family: inherit;
    }

    #generate-btn {
      padding: 0.75rem;
      font-size: 1rem;
      border: none;
      border-radius: 0.5rem;
      background: var(--accent);
      color: white;
      cursor: pointer;
      transition: transform 0.2s ease, background-color 0.3s ease;
    }
    #generate-btn:hover {
      transform: scale(1.03);
    }
    #generate-btn:disabled {
      opacity: 0.7;
      cursor: not-allowed;
    }
    #topic-input:focus {
      outline: none;
      border-color: #6366f1;
    }
    .card {
      perspective: 1000px;
      height: 200px;
      position: relative;
      cursor: pointer;
      transition: transform 0.6s;
      transform-style: preserve-3d;
    }
    .card.flipped .card-inner {
      transform: rotateY(180deg);
    }
    .card-inner {
      width: 100%;
      height: 100%;
      position: absolute;
      transition: transform 0.6s;
      transform-style: preserve-3d;
    }
    .card-front,
    .card-back {
      position: absolute;
      width: 100%;
      height: 100%;
      backface-visibility: hidden;
      border-radius: 1rem;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      padding: 1rem;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      background: white;
      color: black;
      transition: all 0.3s ease;
    }
    .card-back {
      background: #c7d2fe;
      transform: rotateY(180deg);
      color: #111827;
    }
    .card-front span {
      text-transform: uppercase;
      font-size: 0.75rem;
      letter-spacing: 1px;
      color: #6b7280;
      margin-bottom: 0.5rem;
    }
    .card-front p,
    .card-back p {
      font-weight: 600;
      font-size: 1.1rem;
      line-height: 1.4;
    }
    .delete-btn {
      position: absolute;
      top: 0.5rem;
      right: 0.5rem;
      background: #ef4444;
      color: white;
      border: none;
      border-radius: 9999px;
      width: 1.5rem;
      height: 1.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: transform 0.2s ease;
    }
    .delete-btn:hover {
      transform: scale(1.1);
    }
    .delete-btn:focus {
      outline: 2px solid #ef4444;
      box-shadow: 0 0 0 3px #ef444488;
    }

    footer {
      margin-top: 2.5rem;
      text-align: center;
      color: #6366f1;
      font-size: 1.05em;
    }
    footer a {
      color: #6366f1;
      text-decoration: underline;
    }

    .info-section {
      max-width: 700px;
      margin: 2.5rem auto 2rem auto;
      padding: 2rem 1.5rem;
      background: linear-gradient(120deg,#e0e7ff 60%,#f3f4f6 100%);
      border-radius: 1.5rem;
      box-shadow: 0 4px 24px #6366f122;
    }
    .info-section h2 {
      color: #6366f1;
      text-align: center;
      margin-bottom: 0.7em;
      font-size: 2em;
      font-weight: 700;
      letter-spacing: 0.01em;
    }
    .info-section ul {
      list-style: none;
      padding: 0;
      margin: 0 0 1.2em 0;
    }
    .info-section li {
      display: flex;
      align-items: flex-start;
      margin-bottom: 1.1em;
    }
    .info-section li span {
      font-size: 1.5em;
      margin-right: 0.7em;
    }
    .info-section .highlight {
      color: #4338ca;
      font-size: 1.13em;
      font-weight: 500;
      text-align: center;
    }

    .flashcards-section {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 1.5rem;
      margin: 2.5rem 0 2rem 0;
    }
    .flashcard {
      background: linear-gradient(120deg, #f3f4f6 60%, #e0e7ff 100%);
      border-radius: 1.2rem;
      box-shadow: 0 4px 16px #6366f122;
      padding: 1.5rem 1.2rem 1.2rem 1.2rem;
      min-height: 180px;
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      justify-content: flex-start;
      position: relative;
      transition: box-shadow 0.3s, transform 0.3s;
      cursor: pointer;
      overflow: hidden;
      border: 1.5px solid #a5b4fc;
    }
    .flashcard:hover {
      box-shadow: 0 8px 32px #6366f144;
      transform: scale(1.04) translateY(-6px) rotate(-1deg);
      z-index: 2;
    }
    .flashcard .question {
      font-size: 1.13em;
      font-weight: 600;
      color: #4338ca;
      margin-bottom: 1.1em;
      letter-spacing: 0.01em;
    }
    .flashcard .answer {
      font-size: 1.05em;
      color: #22223b;
      background: #e0e7ff;
      border-radius: 0.7em;
      padding: 0.7em 1em;
      margin-top: 0.5em;
      box-shadow: 0 1px 4px #6366f111;
      display: none;
      transition: all 0.3s;
    }
    .flashcard.show-answer .answer {
      display: block;
      animation: fadeInAnswer 0.5s;
    }
    @keyframes fadeInAnswer {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* Developer Info Modal/Section */
    .dev-modal-bg { display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(60,62,100,0.18); z-index:1000; align-items:center; justify-content:center; }
    .dev-modal-bg.active { display:flex; }
    .dev-card { background:#fff; border-radius:1.2rem; box-shadow:0 4px 24px #6366f122; padding:2.5rem 2rem 2rem 2rem; max-width:400px; text-align:center; margin:2rem auto; position:relative; }
    .dev-card h1 { color:#6366f1; margin-bottom:0.5rem; font-size:2.1rem; }
    .dev-card p { color:#444; font-size:1.1rem; margin-bottom:1.2rem; }
    .dev-links a { display:inline-block; margin:0.5rem 0.7rem; color:#6366f1; text-decoration:none; font-weight:500; transition:color 0.2s; }
    .dev-links a:hover { color:#4338ca; text-decoration:underline; }
    .dev-close { position:absolute; top:0.7rem; right:1.1rem; font-size:1.5em; color:#6366f1; background:none; border:none; cursor:pointer; }
    @media (max-width:500px) { .dev-card { padding:1.2rem 0.5rem; } }
  </style>
</head>
<body class="light">
  <div class="container">
    <header>
      <img src="pranit.jpeg" alt="Developer photo" style="width:140px; height:180px; object-fit:cover; border-radius:1.2rem; box-shadow:0 4px 24px #6366f122; margin-bottom:1rem;" />
      <div style="font-size:1.1em; color:#6366f1; margin-bottom:0.5rem; font-weight:500;">Hi, me PRANIT!</div>
      <h1>üß† FlashLearn AI</h1>
      <p style="text-align:center">Smart Flashcards for IIT JEE & NEET</p>
      <button id="theme-toggle">Toggle Dark Mode</button>
    </header>

    <section class="generator">
      <input type="text" id="topic-input" placeholder="Enter topic like 'Photosynthesis' or 'Newton's Laws'" />
      <button id="generate-btn">Generate Flashcards</button>
    </section>

    <section class="flashcards-section" id="flashcards"></section>
    <div id="status-message" style="text-align:center; margin-top:1.5rem; color:#ef4444; font-weight:500;"></div>

    <div id="info-section" style="max-width:700px;margin:2.5rem auto 2rem auto;padding:2rem 1.5rem;background:linear-gradient(120deg,#e0e7ff 60%,#f3f4f6 100%);border-radius:1.5rem;box-shadow:0 4px 24px #6366f122;">
      <h2 style="color:#6366f1;text-align:center;margin-bottom:0.7em;font-size:2em;font-weight:700;letter-spacing:0.01em;">Why Use Flashcards?</h2>
      <ul style="list-style:none;padding:0;margin:0 0 1.2em 0;">
        <li style="display:flex;align-items:flex-start;margin-bottom:1.1em;">
          <span style="font-size:1.5em;margin-right:0.7em;">üß†</span>
          <span><strong>Active Recall:</strong> Test yourself and boost memory retention by flipping cards and recalling answers.</span>
        </li>
        <li style="display:flex;align-items:flex-start;margin-bottom:1.1em;">
          <span style="font-size:1.5em;margin-right:0.7em;">‚è±Ô∏è</span>
          <span><strong>Spaced Repetition:</strong> Review cards regularly to master tough concepts and never forget what matters.</span>
        </li>
        <li style="display:flex;align-items:flex-start;margin-bottom:1.1em;">
          <span style="font-size:1.5em;margin-right:0.7em;">üìö</span>
          <span><strong>Organized Learning:</strong> Group flashcards by chapter or topic for focused, efficient revision.</span>
        </li>
        <li style="display:flex;align-items:flex-start;margin-bottom:1.1em;">
          <span style="font-size:1.5em;margin-right:0.7em;">‚ú®</span>
          <span><strong>AI-Powered:</strong> Instantly generate high-quality flashcards for any subject or exam, tailored to your needs.</span>
        </li>
      </ul>
      <div style="text-align:center;color:#4338ca;font-size:1.13em;font-weight:500;">Start learning smarter, not harder. Your journey to AIR 1 starts here!</div>
    </div>

    <!-- Developer Info Modal/Section -->
    <div style="text-align:center; margin:2.5rem 0 1.5rem 0;">
      <button id="showDevBtn" style="background:#6366f1;color:#fff;padding:0.5em 1.3em;border-radius:1.2em;font-size:1em;font-weight:500;border:none;box-shadow:0 2px 8px #6366f133;cursor:pointer;">About the Developer</button>
    </div>
    <div class="dev-modal-bg" id="devModal">
      <div class="dev-card">
        <button class="dev-close" id="closeDevBtn" title="Close">&times;</button>
        <img src="https://raw.githubusercontent.com/pranitdandewarofficial/flashcards/main/pranit.jpeg" alt="Developer photo" loading="lazy" style="width:110px;height:140px;object-fit:cover;border-radius:1.1rem;box-shadow:0 2px 12px #6366f122;margin-bottom:1rem;" />
        <h1>PRANIT</h1>
        <p>Developer of FlashLearn AI.<br>Passionate about helping AIR 1 IIT JEE aspirants achieve their dreams with smart, AI-powered learning tools.</p>
        <div class="dev-links">
          <a href="mailto:busines.pranit@email.com">Email</a>
          <a href="https://github.com/pranitdandewarofficial" target="_blank">GitHub</a>
          <a href="https://twitter.com/pranitdandewar" target="_blank">Twitter</a>
          <a href="https://linkedin.com/in/yourlinkedin" target="_blank">LinkedIn</a>
        </div>
      </div>
    </div>

    <footer>
      Made for <strong>AIR 1 IIT JEE Aspirants</strong> | Developed by <a href="developer.html">PRANIT</a>
    </footer>
  </div>

  <script>
    const topicInput = document.getElementById("topic-input");
    const generateBtn = document.getElementById("generate-btn");
    const flashcardsContainer = document.getElementById("flashcards");
    const themeToggle = document.getElementById("theme-toggle");

    let cards = [];
    let GEMINI_API_KEY = localStorage.getItem('gemini_api_key') || "AIzaSyB7wqnH__VvoyrN-MIP7GhAWgRhrE48JtQ";
    const statusMessage = document.getElementById('status-message');

    // Load saved cards from localStorage
    window.addEventListener('load', () => {
      const savedCards = localStorage.getItem('flashcards');
      if (savedCards) {
        cards = JSON.parse(savedCards);
        renderCards();
      }

      // Load saved theme
      const savedTheme = localStorage.getItem('theme') || 'light';
      document.body.className = savedTheme;
      themeToggle.textContent = savedTheme === 'dark' ? 'Toggle Light Mode' : 'Toggle Dark Mode';
    });

    // Toggle light/dark mode
    themeToggle.addEventListener("click", () => {
      const body = document.body;
      body.classList.toggle("dark");
      body.classList.toggle("light");
      
      themeToggle.textContent = body.classList.contains("dark") ? "Toggle Light Mode" : "Toggle Dark Mode";
      localStorage.setItem("theme", body.classList.contains("dark") ? "dark" : "light");
    });

    // Save cards to localStorage and to a file by topic/chapter
    function saveCards() {
      localStorage.setItem('flashcards', JSON.stringify(cards));
      // Save by chapter/topic
      const byTopic = {};
      cards.forEach(card => {
        const topic = card.topic || 'General';
        if (!byTopic[topic]) byTopic[topic] = [];
        byTopic[topic].push(card);
      });
      Object.keys(byTopic).forEach(topic => {
        const safeTopic = topic.replace(/[^a-z0-9]/gi, '_').toLowerCase();
        const fileName = `flashcards/${safeTopic}.json`;
        // Save each topic's cards as a JSON file (AI managed)
        window.saveFlashcardFile && window.saveFlashcardFile(fileName, JSON.stringify(byTopic[topic], null, 2));
      });
    }

    // Render flashcards to the DOM
    function renderCards() {
      flashcardsContainer.innerHTML = '';
      
      if (cards.length === 0) {
        const emptyMessage = document.createElement('div');
        emptyMessage.style.textAlign = 'center';
        emptyMessage.style.marginTop = '2rem';
        emptyMessage.style.gridColumn = '1 / -1';
        emptyMessage.textContent = 'No flashcards yet. Enter a topic above!';
        flashcardsContainer.appendChild(emptyMessage);
        return;
      }

      cards.forEach((card, index) => {
        const cardElement = document.createElement('div');
        cardElement.className = 'flashcard';
        cardElement.dataset.index = index;

        cardElement.innerHTML = `
          <div class="question">${card.front}</div>
          <div class="answer">${card.back}</div>
        `;

        // Add click event for showing answer
        cardElement.addEventListener('click', (e) => {
          cardElement.classList.toggle('show-answer');
        });

        flashcardsContainer.appendChild(cardElement);
      });
    }

    // Generate flashcards using Gemini AI
    async function generateFlashcardsWithGemini(input) {
      statusMessage.textContent = '';
      try {
        const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${GEMINI_API_KEY}`,
        {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            contents: [{
              parts: [{
                text: `Generate 20 flashcards for the topic "${input}". Format them as JSON like this:\n[\n  { "question": "Question 1", "answer": "Answer 1" },\n  ...\n]`
              }]
            }]
          })
        });

        if (!response.ok) {
          throw new Error(`API error: ${response.status}`);
        }

        const data = await response.json();
        const rawText = data.candidates?.[0]?.content?.parts?.[0]?.text;

        if (!rawText) {
          throw new Error("No response from Gemini");
        }

        let parsed;
        try {
          const cleanText = rawText
            .replace(/```json\n?/, '')
            .replace(/\n?```$/, '')
            .trim();
          parsed = JSON.parse(cleanText);
        } catch (e) {
          console.error("Gemini returned invalid JSON:", rawText);
          throw new Error("Gemini returned invalid JSON");
        }

        parsed.forEach(c => {
          cards.unshift({
            id: Date.now() + Math.random(),
            topic: input,
            front: c.question,
            back: c.answer,
            flipped: false
          });
        });

        saveCards();
        renderCards();
        statusMessage.textContent = '';
      } catch (error) {
        console.error(error);
        if (error.message.includes('API error') || error.message.includes('No response') || error.message.includes('invalid JSON')) {
          statusMessage.textContent = 'AI error: ' + error.message + '. Please check your API key.';
          let newKey = prompt('Gemini API key invalid or quota exceeded. Enter a new Gemini API key:');
          if (newKey) {
            GEMINI_API_KEY = newKey;
            localStorage.setItem('gemini_api_key', newKey);
            statusMessage.textContent = 'Trying again with your new API key...';
            await generateFlashcardsWithGemini(input);
            return;
          } else {
            statusMessage.textContent = 'No valid API key provided. Cannot generate flashcards.';
          }
        } else {
          statusMessage.textContent = 'Error: ' + error.message;
        }
        cards.unshift({
          id: Date.now(),
          topic: input,
          front: `Error generating cards.`,
          back: "Please try again later.",
          flipped: false
        });
        saveCards();
        renderCards();
      } finally {
        generateBtn.disabled = false;
        generateBtn.textContent = "Generate Flashcards";
      }
    }

    // Event listener for generate button
    generateBtn.addEventListener("click", () => {
      const topic = topicInput.value.trim();
      if (!topic) return;
      
      generateBtn.disabled = true;
      generateBtn.textContent = "Generating...";
      
      generateFlashcardsWithGemini(topic);
    });

    // For development only - remove in production
    function testMockCards() {
      const mockCards = [
        {
          id: Date.now(),
          topic: "Newton's Laws",
          front: "What is Newton's First Law?",
          back: "An object remains at rest or in uniform motion unless acted upon by a force."
        },
        {
          id: Date.now() + 1,
          topic: "Photosynthesis",
          front: "Where does photosynthesis occur?",
          back: "Chloroplasts in plant cells."
        }
      ];
      
      cards = [...mockCards, ...cards];
      saveCards();
      renderCards();
    }

    // Uncomment to test with mock cards without Gemini API
    // testMockCards();

    (function() {
      // Only show info section if not dismissed before
      if (localStorage.getItem('hideInfoSection')) {
        document.getElementById('info-section').style.display = 'none';
      }
      // Hide info section after flashcards are generated or viewed
      function hideInfoSection() {
        document.getElementById('info-section').style.display = 'none';
        localStorage.setItem('hideInfoSection', '1');
      }
      // Attach to flashcard generation and viewing events
      document.addEventListener('DOMContentLoaded', function() {
        var flashcardsSection = document.querySelector('.flashcards-section');
        if (flashcardsSection) {
          flashcardsSection.addEventListener('click', hideInfoSection, { once: true });
        }
        var genBtn = document.getElementById('generate-btn');
        if (genBtn) {
          genBtn.addEventListener('click', hideInfoSection, { once: true });
        }
      });
    })();

    // Developer info modal script
    document.getElementById('showDevBtn').onclick = function() {
      document.getElementById('devModal').classList.add('active');
    };
    document.getElementById('closeDevBtn').onclick = function() {
      document.getElementById('devModal').classList.remove('active');
    };
    // Optional: close modal on background click
    document.getElementById('devModal').onclick = function(e) {
      if (e.target === this) this.classList.remove('active');
    };
  </script>
</body>
</html>
